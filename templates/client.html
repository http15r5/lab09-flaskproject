{% extends "base.html" %}
{% block title %}Панель клієнта{% endblock %}
{% block content %}
                               
<link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
<script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
<div class="bg-white shadow-lg rounded-2xl p-8 mt-6 border border-pink-200 max-w-6xl mx-auto">
    <h1 class="text-3xl font-extrabold mb-6 text-pink-700 text-center">Панель клієнта</h1>

                                                        <!-- Відгуки -->
    <h2 class="text-2xl font-semibold mb-4 text-purple-700 border-b pb-2">Відгуки користувачів</h2>

    <div class="overflow-x-auto mb-10">
        <table class="min-w-full border border-pink-200 rounded-xl overflow-hidden">
            <thead class="bg-gradient-to-r from-pink-400 to-purple-400 text-white">
                <tr>
                    <th class="py-3 px-4 text-left">ID</th>
                    <th class="py-3 px-4 text-left">Ім’я</th>
                    <th class="py-3 px-4 text-left">Email</th>
                    <th class="py-3 px-4 text-left">Повідомлення</th>
                    <th class="py-3 px-4 text-center">Дії</th>
                </tr>
            </thead>
            <tbody>
                {% for fb in feedbacks %}
                <tr class="hover:bg-pink-50 border-b border-pink-100">
                    <td class="py-3 px-4">{{ fb['id'] }}</td>
                    <td class="py-3 px-4">{{ fb['name'] }}</td>
                    <td class="py-3 px-4">{{ fb['email'] }}</td>
                    <td class="py-3 px-4">{{ fb['message'] }}</td>
                    <td class="py-3 px-4 text-center">
                        <form action="{{ url_for('client.client_delete_feedback', feedback_id=fb['id']) }}" method="POST" style="display:inline;">
                            <button type="submit" class="text-red-600 hover:text-red-800 font-semibold transition">Видалити</button>
                        </form>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="5" class="py-4 text-center text-gray-500 italic">Немає відгуків</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

                                                 <!--Замовлення-->
    <h2 class="text-2xl font-semibold mb-4 text-purple-700 border-b pb-2 text-center">Мої замовлення</h2>

    {% if orders %}
    <div class="overflow-x-auto">
        <table class="min-w-full border border-pink-200 rounded-xl overflow-hidden">
            <thead class="bg-gradient-to-r from-purple-400 to-pink-400 text-white">
                <tr>
                    <th class="py-3 px-4 text-left">ID</th>
                    <th class="py-3 px-4 text-left">Адреса</th>
                    <th class="py-3 px-4 text-left">Ціна</th>
                    <th class="py-3 px-4 text-left">Статус</th>
                    <th class="py-3 px-4 text-left">Дата</th>
                    <th class="py-3 px-4 text-left">Промокод</th>
                    <th class="py-3 px-4 text-center">Дії</th>
                </tr>
            </thead>
            <tbody>
                {% for o in orders %}
                <tr id="order-{{ o.id }}" class="hover:bg-purple-50 border-b border-pink-100">
                    <td class="py-3 px-4">{{ o.id }}</td>
                    <td class="py-3 px-4">{{ o.address }}</td>
                    <td class="py-3 px-4">{{ o.total_price }}</td>
                    <td class="py-3 px-4">
                        {% if o.status == "Очікує скасування" %}
                            <span class="text-yellow-600 font-semibold">Очікує скасування</span>
                        {% elif o.status == "Скасовано" %}
                            <span class="text-red-600 font-semibold">Скасовано</span>
                        {% else %}
                            <span class="text-green-600 font-semibold">{{ o.status }}</span>
                        {% endif %}
                    </td>
                    <td class="py-3 px-4">{{ o.date }}</td>
                    <td class="py-3 px-4">{{ o.promo_code if o.promo_code else "-" }}</td>
                    <td class="py-3 px-4 text-center">
                        <button onclick="openDetailsModal({{ o.id }})"
                                class="bg-pink-500 hover:bg-pink-600 text-white font-semibold px-4 py-1 rounded-lg shadow transition">
                            Детальніше
                        </button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="text-center text-gray-600 italic mt-6 text-lg">У вас ще немає замовлень</div>
    {% endif %}
</div>

                                        <!--Модальне вікно деталей-->
<div id="detailsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-lg w-full relative">
    <h2 class="text-2xl font-bold text-pink-700 mb-4 text-center">Деталі замовлення</h2>
    <div id="detailsContent" class="text-gray-700 space-y-2 text-lg"></div>
    <div id="orderProducts" class="mt-4 bg-pink-50 p-3 rounded-xl border border-pink-200">
      <h3 class="text-xl font-semibold text-pink-700 mb-2">Замовлені товари:</h3>
      <ul id="productsList" class="list-disc list-inside text-gray-800"></ul>
    </div>
    <div class="flex justify-center mt-6 gap-4 flex-wrap">
      <button id="cancelInsideBtn" class="hidden bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg">Скасувати</button>
      <button id="deleteInsideBtn" class="hidden bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg">Видалити</button>
      <button onclick="closeDetailsModal()" class="bg-pink-500 hover:bg-pink-600 text-white px-6 py-2 rounded-lg">Закрити</button>
    </div>
  </div>
</div>

                                           <!--Модальні вікна-->
<div id="cancelModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-md w-full text-center">
    <h2 class="text-2xl font-bold text-pink-700 mb-4">Підтвердження скасування</h2>
    <p class="text-gray-700 mb-6">Ви дійсно хочете скасувати це замовлення?</p>
    <div class="flex justify-center gap-4">
      <button id="confirmCancelBtn" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg">Так</button>
      <button onclick="closeCancelModal()" class="bg-gray-300 hover:bg-gray-400 px-6 py-2 rounded-lg">Ні</button>
    </div>
  </div>
</div>

<div id="deleteModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-md w-full text-center">
    <h2 class="text-2xl font-bold text-pink-700 mb-4">Видалити замовлення</h2>
    <p class="text-gray-700 mb-6">Ви впевнені, що хочете <b>видалити</b> це замовлення назавжди?</p>
    <div class="flex justify-center gap-4">
      <button id="confirmDeleteBtn" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg">Так</button>
      <button onclick="closeDeleteModal()" class="bg-gray-300 hover:bg-gray-400 px-6 py-2 rounded-lg">Ні</button>
    </div>
  </div>
</div>
{% endblock %}

