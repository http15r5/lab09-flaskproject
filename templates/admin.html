{% extends "base.html" %}
{% block title %}Адмін-панель{% endblock %}
                                           <!--зробив (Діма Чаркін) полагодив та оформив (Стас Мельник, Максим Пахольчук)-->
{% block content %}
<script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
<div class="admin-wrapper">
  <div class="admin-header">
    <h1>Адмін-панель</h1>
    <p>Керування замовленнями, товарами та повідомленнями користувачів</p>
  </div>

  <div class="card add-product-card">
  <h2 class="text-2xl font-bold mb-4 text-center flex items-center justify-center gap-2 text-purple-600">
    <span style="font-size: 26px;">➕</span> Додати новий товар
  </h2>

  <form action="{{ url_for('admin.add_product') }}" method="POST" class="add-product-row">
    <div class="input-group">
      <label>Назва товару</label>
      <input type="text" name="name" placeholder="Назва" required>
    </div>

    <div class="input-group">
      <label>Ціна</label>
      <input type="number" name="price" step="0.01" placeholder="Ціна" required>
    </div>

    <div class="input-group">
      <label>Посилання на зображення</label>
      <input type="url" name="image" placeholder="https://example.com/image.jpg" required>
    </div>

    <button type="submit" class="add-btn">Додати товар</button>
  </form>
</div>
    <!-- товар -->
  <div class="card">
    <button class="toggle-btn" id="toggleProducts">
      Товари
      <span class="toggle-icon" id="iconProducts">▼</span>
    </button>
    <div class="toggle-content" id="sectionProducts">
      <div class="table-container mt-3">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Назва</th>
              <th>Ціна</th>
              <th>Зображення</th>
              <th>Дії</th>
            </tr>
          </thead>
          <tbody>
            {% for product in products %}
            <tr>
              <td>{{ product['id'] }}</td>
              <td>{{ product['name'] }}</td>
              <td>{{ product['price'] }} $</td>
              <td>
                {% if product['image'] %}
                  <img src="{{ product['image'] }}" alt="image" class="product-img">
                {% else %}
                  <span style="color:#aaa;">(без зображення)</span>
                {% endif %}
              </td>
              <td>
                <form action="{{ url_for('admin.delete_product', product_id=product['id']) }}" method="post" style="display:inline;">
                  <button type="submit" class="btn small danger">Видалити</button>
                </form>
              </td>
            </tr>
            {% else %}
            <tr><td colspan="5" class="empty">Список товарів порожній</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

                                            <!-- замовлення -->
  <div class="card">
    <button class="toggle-btn" id="toggleOrders">
      Замовлення
      <span class="toggle-icon" id="iconOrders">▼</span>
    </button>
    <div class="toggle-content" id="sectionOrders">
      <div class="table-container mt-3">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Email</th>
              <th>Сума</th>
              <th>Статус</th>
              <th>Дата</th>
              <th>Дії</th>
            </tr>
          </thead>
          <tbody>
            {% for order in orders %}
            <tr>
              <td>{{ order['id'] }}</td>
              <td>{{ order['email'] }}</td>
              <td>{{ order['total_price'] }} $</td>
              <td>
                <span class="status
                  {% if order['status'] == 'Нове' %}new
                  {% elif order['status'] == 'В обробці' %}process
                  {% elif order['status'] == 'Відправлено' %}sent
                  {% elif order['status'] == 'Доставлено' %}delivered
                  {% else %}cancelled{% endif %}">
                  {{ order['status'] }}
                </span>
              </td>
              <td>{{ order['date'] }}</td>
              <td>
                <a href="{{ url_for('admin.order_details', order_id=order['id']) }}" class="btn small view">Деталі</a>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

                                                                    <!-- відгуки -->
  <div class="card">
    <button class="toggle-btn" id="toggleFeedback">
      Повідомлення зворотного зв’язку
      <span class="toggle-icon" id="iconFeedback">▼</span>
    </button>
    <div class="toggle-content" id="sectionFeedback">
      <div class="table-container mt-3">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Ім’я</th>
              <th>Email</th>
              <th>Повідомлення</th>
              <th>Дії</th>
            </tr>
          </thead>
          <tbody>
            {% for item in feedback %}
            <tr>
              <td>{{ item['id'] }}</td>
              <td>{{ item['name'] }}</td>
              <td>{{ item['email'] }}</td>
              <td class="message-cell">{{ item['message'] }}</td>
              <td>
                <form action="{{ url_for('admin.delete_feedback', id=item['id']) }}" method="post">
                  <button type="submit" class="btn small danger">✕</button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

{% endblock %}
